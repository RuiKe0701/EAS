<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruike.eas.dao.LeaveMapper">
<insert id="insertleave" useGeneratedKeys="true" keyProperty="sad_id" parameterType="java.util.List">
    INSERT into stuleave(stu_id,class_id,stuleave_remarks,stuleave_state,stuleave_day)
    values
    <foreach collection="list" item="item" index="index" separator="," >
        (#{item.stu_id},#{item.class_id},#{item.stuleave_remarks},#{item.stuleave_state},#{item.stuleave_day})
    </foreach>
</insert>
    <resultMap id="leaves" type="com.ruike.eas.pojo.Stuleave">
        <result property="stuname" column="stuname"></result>
        <result property="classname" column="classname"></result>
    </resultMap>
    <select id="selectByleave" resultMap="leaves">
        SELECT sl.*,s.stu_name as stuname,c.class_name as classname from stuleave as sl,stu as s,class as c
        <where>
            sl.stu_id=s.stu_id and sl.class_id=c.class_id
            <if test="stuleave_day!=null">
             and sl.stuleave_day=#{stuleave_day}
            </if>
            <if test="class_id!=null and class_id>0">
             and sl.class_id=#{class_id}
            </if>
            <if test="stuleave_id!=null">
            and sl.stuleave_id=#{stuleave_id}
            </if>
        </where>
        ORDER BY stuleave_day DESC

    </select>


    <update id="updateleave">
        update stuleave set stuleave_state=#{stuleave_state},stuleave_remarks=#{stuleave_remarks} where stuleave_id =#{stuleave_id}
    </update>

</mapper>